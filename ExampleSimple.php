<?php

/**
 * @author Rafal Masiarek <rafalmasiarek@hotmail.com>
 * @author  Mustache Lab <kontakt@mustachelab.pl>
 * @copyright Copyright (c) 2015, Rafal Masiarek
 *
 * @version 2.0
 */
/*

                                                                      `.:'+###++++++#++##+;:.`
                                                                `:+##+++++++++++++++++++++++++++##+:`
                                                            :+##+++++++++++++#++++++++++++++++++++++++##;`
                                                        ;##+++++++++++++++++#+++++++++#++++++++++++++++#++##'`
                                                    ,###++#++++++++++####+++';::,,,::;'+++###+++++++++++++++++##:
                                                `:#+++++++++++####+;,                         .;'####++#++#++++++##'`
                                              ;@++++++++#++##':                                     ,;###+##+++++++#+#;
                                           ;@++++++++++##'.                                             `:##++++#+++++++@:
                                        .##+++++++++#+.                                                     `+#++++#++++++#+`
                                      '#++#+++#++#'`                         .:''+#####+,                       ;#+++++++++++#,
                                   .#+#+++++++#'`              `'###      .@+++++++++++++#'     @',`               ;##+++++++++#;
                                 ;@++++++++##.                @++++#     ++++++++++++++++++#`   #+++#@+:             `+#++++++++##+
                               +#++++++++#;                   #+#++#    :+++#+++++++++++++++#   ##+++++++##;`           ,#+++++++#++#
                            `##+++++##+#.                     ##+++#    #+++++++#+;:'#++++++++  #+++++++++++##+.          `+####++++#+#`
                          .##+++++#+#+`          `:++;,       #++++#    @#++++#,      ;++++++#  #+++++++++++++++##,          '#+++++++#+#`
                        .@+#++++++#+          `'#++++++#;     #++++#    @+++++'        #+++++#  #+++++;#+++++++++++#'          ;#+++++++++#`
                      .#++++++++#+          ;@+++++++++++#    #++++#    @+++++'        #+++++#  #++++#`.#++++++#+++++#           ;#++++++++++
                    .#+++++#+++#         `##++++++++++++++.   #++++#    @+++++'        #+++++#  #++++#  .+++++++++++++#            '#++++++++#+
                   #++#++++++#`         @++#++++++++++++++#   #++++#    @+++++'           ````  #++++#   +#+++'#+++++++'             ++++++++++#:
                 ++++++++++#,       `.  #+++++##. `+#+++++@   #++++#    @+++++'                 #++++#   ,++++' ++#+++++        `      #++#++++++#`
               :#++++++++#'       `#+,  #++++#      ++++++@   #++++#    @+++++'                 #++++#   :++++'  #++++++       +++`     .#++++++++++
              #+++++++#+#        +#++,  #++++#      :++++#@   #++++#    @#++++'                 #++++#   :++++;  ,+++++'      ;++##+      :#++++++++#.
            ,#+++++++++;       ;#+#++,  @#+++#      :+++++@   #++++#    @+++++'                 #++++#   :++++;  `#++++'      #+++++#+      #+++++++++'
           +++++++++##`      ,#+#++++:  #++++#      ,+++++#   #++++#    @+++++'                 #++++#   ;++++:   #++++'     #++#+++#+#'     ,#++++++#+#
          #++++++++++       #+++++++#;  #++++#      ,+++++#   #++++#    @+++++'                 #++++#   ;++++:   #++++;    ,++++#++++++#'     +++++++++#
         ##+++++++#.      '#++++#+#;    #++++#      ,+++++#   #++++#    @+++++'                 #++++#   ;++++,  `#++++;    #++++ ;#++#+++#     .#+++++++#
        #++++++++#      `#++++++#;      ##+++#      .+++++#   #++++#    @+++++'                 #++++#   ;++++,  `#++++:   .+#++#   ;+#+++#       #+++++++#
       '++++++++@      :#++#+++#        +++++#      .+++++#   #++++#    @+++++;                 #++++#   '++++,  `+++++:   ##+++,    @+++++        :#++++++#
      `++++++++#      +++++++#`         +++++#      `+++++#   #++++#    @+++++;                 #++++#   '++++.  `+++++,   #+++#     @+++++        ;#++++++++
      #+++++++++#`    #++++++           +++++#      `+++++#   #++++#    @+++++;                 #++++#   '++++.  `+++++.  .++++#     #+++++       #++++++++++`
     `+++++++++++#    #++++'            '++++#      `+++++#   #++++#    @+++++;                 #++++#   '++++.  `+++++.  '++++'     #++++'      #+++++++++++#
     +++++++++++++;   #++++;            '++++#      `+++++#   #++++#    @+++++;                 #++++#   '++++`  `+++++`  +++++`     #++++'     :+#++++++++++#
     #++++#'#+++++#   #++++;            '++++#      `+++++#   #++++#    @+++++;                 #++++#   +++++`  `+++++`  #++++      #++++;     #++#++##+#++++;
     ++++#   ;++++#   #++++',,,,::`     ;++++#      `+++++#   #++++#    @+++++;  .............  #++++#   +++++`  .+++++   #+++#      +++++:     #++++   ;+++++#
     +++++    #++++   +#++++++++++.     ;++++#       #++++#   #++++#    @+++++;  ##++++++++#++  #++++#   ++++#`  .+++++   #+++#      +++++:    `#+++#    #+++++
     ++++#   .+++#+   ++++++++++++,     :++++#       #++++#   #++++#    @+++++;  @++++++++++++  #++++#   ++++#`  .+++++   +++++    '#+++++,    `#+++#   .#+++++
     #++++#`:#++++#   '+++++++++++:     :++++#       #++++#   #++++#    @+++++;  @++++++++++++  #++++#   ++++#`  ,++++#  .#++++ :#++#+++++.     #+++++ .#++++++
     ++#+++++++++#+   ;#++++++++++:     ,+++++`      #++++#   #++++#    #+++++;  @++++#++++++'  #++++#   ++++#   ,++++#  :#++++#++++++++++.     #+#++++++++++++
     ;#++++++++++#`   ;+++++            .+++++`      #++++#   ##+++#    #+++++;  `      #++++'  #++++#   ++++#   :++++#  ;++++++++++++++++`     .+++++++++++++.
      ##+++++++++;    :++++'            .+++++`      #++++#   #++++#    #+++++;         #++++'  #++++#   #+++#   :++++#  '++++++++#':++++#`      +++++++++++##
      +++++++++#:     ,++++'            `+++++`      #++++#   #++++#    #+++++;         #++++'  #++++#   #+++#   :++++#  '++++++#;  :++++#`       +++++++++++:
       #++++++#       ,++++#`           `+++++`      #++++#   #++++#    #+++++;         #++++'  #++++#   #+++#   ;++++#  '++++#,    ;++++#         +#++++++##
        ++++++++      .+++++++           +++++.      #++++#   +++++#`   #+++++;         #++#+;  #++++#   #+++#   ;++++#  +++++      ;++++#        #+#++++++#
        .###++++#     .#++++#+#+`        +++++.      #+++++   +++++#`   #+++++:         #++++;  #++++#   #+++#   '++++#  +++++`     ;++++#      ;+++++++++#
         `#++++#+#,     ##+++++++@:      #++++,      #+++++   +++++#`   #+++++:         #++++;  #++++#   #+++#   '++++#  +++++`     ;++#+#    `@#++++++++#
           #++++++++     .#+#++++++#@'   #++++,      #+++++   +++++#`   #+++++:         #++++;  #++++#   #+++#   '++++#  +++++`     ;++#+    +++++++++++#
            #++++++##,     .#++++++#++   #++++:      #+++++   '++++#`   #+++++:         #++++;  #+++++   #+++#   +++++#  +++++`     '#;    ,#++#++++++#:
             ,#+++++++#      `+#+++++#`  #++++:      #+++++   '++++#`   ++#+++:         #++++:  #+++++   @+++#   +++++#  #++++`     .    `#+#++#+++++#
               ++++++++#'       :##+++.  #++++:      #+++++   '++++#`   ++++++:         #++++:  #+++++   @+++#   +++++#  #++++.         #++++++++++#:
                `#+#+++++#'       `+#+,  #++++;      #+++++   ;++++#`   ++++++:         #++++:  #++++'   @+++#   +++++#  #+++#,       +++#++++#++#+
                  ,#++#++++#;        ;:  #++++;      #+++++   ;+++++`   ++++++:         #++++:  #++++'   @+++#   +++++#  #+#;       +#++++++++++#`
                    ;#+++++++#;          @++++'      #+++++   :+++++`   ++++++:         #++++,  #++++'   @+++#   #+++++  '`       +#+++++++#++@.
                      ;#+++++++#+         .+#+'      #+++++   :+++++`   ++++++,         #++++,  #++++;   @+++#   #+#+##         +#++++++++++#:
                        ;#++#+#++##.         ,+      #+++#+   :+++++`   ++++++,         #++++,  #++++;   @+#+#   ###,        .#+++++++++++#;
                          ;#++#+++++#'               #+++++`  ,+++++`   ++++++#        ;+++#+.  #++++:   #+++#   .         ;#+++++++++++#;
                            ,@+#++++++##,            @#++++`  ,+++++.   +++++++#:.```,#++++#+`  #++++:   #+#@+          .+#+++++++++###;
                              .#+##++++++#+,           ,'@+`  ,+#+++.   ,+++++++++###+++++++#   #++#+:   '.           ;#++++++++++++@:
                                 ;#+++++#+++#+:               ,+++++.    #++++++++#+++++++++.   #+##'`             ;##+#++++++++++#.
                                   .##+++++++++##'`            `'###.     #+++++++++#++++++'    `              `'#+++++++++++++#'
                                      :##+#++++++++##;`                    ,#++++++++++++#:                 .##+++++++++++++##.
                                         ;@+++++++++++###;.                   .........`                ,+##++++#+++++++++#:
                                            :@+++++++++++++###;,                                   ,;+##+++++++++#+++++@,
                                               .###+#+++++++++++###++':`                    .:'+###++++++++++++#+++#+.
                                                   ,+##++++++++++#+++++++######++++++######+++#+++#++++++++++#+#+:
                                                       ,'##+#+++++++++++++++++++++++++++++++++++++++++++++##+:
                                                            ,'@#+++++++++++++++++++++++++++++++++++++##+:`
*/

declare(strict_types=1);

use JulienBoudry\Enigma\{Enigma, EnigmaModel, Letter, ReflectorType, RotorConfiguration, RotorPosition, RotorType};

require_once 'vendor/autoload.php';

$rotorsConfiguration = new RotorConfiguration(
    p1: RotorType::I,
    p2: RotorType::II,
    p3: RotorType::III,
    ringstellungP1: Letter::B,
);
$enigma = new Enigma(EnigmaModel::WMLW, $rotorsConfiguration, ReflectorType::B);
$enigma->setPosition(RotorPosition::P1, Letter::M);

$enigma->plugLetters(Letter::A, Letter::C);
$enigma->plugLetters(Letter::B, Letter::Z);

$enigma->unplugLetters(Letter::A);

$l = Letter::A;
echo 'before: ' . $enigma->getPosition(RotorPosition::P3)->toChar() . ' ' . $enigma->getPosition(RotorPosition::P2)->toChar() . ' ' . $enigma->getPosition(RotorPosition::P1)->toChar() . "\n";
echo $l->toChar() . '->' . $enigma->encodeLetter($l)->toChar() . "\n";
echo 'after: ' . $enigma->getPosition(RotorPosition::P3)->toChar() . ' ' . $enigma->getPosition(RotorPosition::P2)->toChar() . ' ' . $enigma->getPosition(RotorPosition::P1)->toChar() . "\n";
